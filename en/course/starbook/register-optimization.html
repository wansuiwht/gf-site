<!doctype html><html lang=en-US dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-course/starbook/第二章-用户注册/2.4.业务优化" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.6.3"><title data-rh=true>2.4 Business Optimization | GoFrame官网 - 类似PHP-Laravel,Java-SpringBoot的Go企业级开发框架</title><meta data-rh=true name=viewport content="width=device-width,initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://goframe.org/en/course/starbook/register-optimization><meta data-rh=true property=og:locale content=en_US><meta data-rh=true property=og:locale:alternate content=zh_Hans><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="2.4 Business Optimization | GoFrame官网 - 类似PHP-Laravel,Java-SpringBoot的Go企业级开发框架"><meta data-rh=true name=description content="Problems and optimization solutions in the registration process, including interface parameter validation, prohibiting duplicate usernames, password encryption methods, and function parameter optimization. Use the GoFrame framework for parameter validation, including basic username and password verification, and implement multilingual support with i18n. By setting unique database indexes, ensure user uniqueness and use MD5 encryption to protect password security, enhancing system security and usability."><meta data-rh=true property=og:description content="Problems and optimization solutions in the registration process, including interface parameter validation, prohibiting duplicate usernames, password encryption methods, and function parameter optimization. Use the GoFrame framework for parameter validation, including basic username and password verification, and implement multilingual support with i18n. By setting unique database indexes, ensure user uniqueness and use MD5 encryption to protect password security, enhancing system security and usability."><meta data-rh=true name=keywords content="registration process optimization,interface parameter validation,username validation,password encryption,GoFrame framework,i18n multilingual,data uniqueness,structure optimization,validation rules,password security"><link data-rh=true rel=icon href=/en/img/favicon.ico><link data-rh=true rel=canonical href=https://goframe.org/en/course/starbook/register-optimization><link data-rh=true rel=alternate href=https://goframe.org/course/starbook/register-optimization hreflang=zh-Hans><link data-rh=true rel=alternate href=https://goframe.org/en/course/starbook/register-optimization hreflang=en-US><link data-rh=true rel=alternate href=https://goframe.org/course/starbook/register-optimization hreflang=x-default><link data-rh=true rel=preconnect href=https://ZQUL8VI47R-dsn.algolia.net crossorigin><link rel=search type=application/opensearchdescription+xml title="GoFrame官网 - 类似PHP-Laravel,Java-SpringBoot的Go企业级开发框架" href=/en/opensearch.xml><script src=https://hm.baidu.com/hm.js?38f38a0626fd7805722db06243cd0fa7 async></script><link rel=stylesheet href=/en/assets/css/styles.92978a22.css><script src=/en/assets/js/main.3eb9db35.js defer></script><script src=/en/assets/js/runtime~main.6e7c3d70.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="navbar navbar--fixed-top"><div class=navbar__inner><div class=navbar__items><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/en/><div class=navbar__logo><img src=/en/img/logo2.png alt="GoFrame Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/en/img/logo2.png alt="GoFrame Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" sidebarid=quickSidebar href=/en/quick/install>QuickStart</a><a class="navbar__item navbar__link" sidebarid=mainSidebar href=/en/docs/cli>Documents</a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current=page class="navbar__link active" aria-haspopup=true aria-expanded=false role=button sidebarid=courseSidebar href=/en/course>Courses</a><ul class=dropdown__menu><li><a class=dropdown__link sidebarid=courseSidebar href=/en/course/bilibili-video>Video Tutorial(Chinese)</a><li><a aria-current=page class="dropdown__link dropdown__link--active" sidebarid=courseStarBookSidebar href=/en/course/starbook>Practical Tutorial - Star English Book</a></ul></div><a class="navbar__item navbar__link" href=/en/showcase>ShowCase</a><a class="navbar__item navbar__link" href=/en/release/note>Release</a><a class="navbar__item navbar__link" sidebarid=communitySidebar href=/en/share/group>Community</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class=navbar__link aria-haspopup=true aria-expanded=false role=button href=/en/course/starbook/register-optimization>2.8.x(Latest)</a><ul class=dropdown__menu><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/en/course/starbook/register-optimization>2.8.x(Latest)</a><li><a class=dropdown__link href=/en/2.7.x/docs/design>2.7.x</a><li><a class=dropdown__link href=/en/2.6.x/项目开发>2.6.x</a><li><a class=dropdown__link href=/en/2.5.x/项目开发>2.5.x</a><li><a class=dropdown__link href=/en/2.4.x/开发工具>2.4.x</a><li><a class=dropdown__link href=/en/2.3.x/开发工具>2.3.x</a><li><a class=dropdown__link href=/en/2.2.x/开发工具>2.2.x</a><li><a class=dropdown__link href=/en/2.1.x/开发工具>2.1.x</a><li><a class=dropdown__link href=/en/2.0.x/开发工具>2.0.x</a><li><a class=dropdown__link href=/en/1.16.x/开发工具>1.16.x</a></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>English</a><ul class=dropdown__menu><li><a href=/course/starbook/register-optimization rel="noopener noreferrer" class=dropdown__link lang=zh-Hans>简体中文</a><li><a href=/en/course/starbook/register-optimization rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=en-US>English</a></ul></div><a href=https://github.com/gogf/gf target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/en/course/starbook>Practical Tutorial - Star English Book</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/course/starbook/about>Chapter 1 - Basic Information</a><button aria-label="Expand sidebar category 'Chapter 1 - Basic Information'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/en/course/starbook/register>Chapter 2 - User Registration</a><button aria-label="Collapse sidebar category 'Chapter 2 - User Registration'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/course/starbook/register-overview>2.1 Preface</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/course/starbook/register-model>2.2 Data Model</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/course/starbook/register-general>2.3 Registration API</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/en/course/starbook/register-optimization>2.4 Business Optimization</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/course/starbook/register-api-doc>2.5 API Documentation</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/course/starbook/register-summary>2.6 Summary</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/course/starbook/session>Chapter 3 - Session Management</a><button aria-label="Expand sidebar category 'Chapter 3 - Session Management'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/course/starbook/word>Chapter 4 - Word Management</a><button aria-label="Expand sidebar category 'Chapter 4 - Word Management'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/course/starbook/learn-word>Chapter 5 - Learning Words</a><button aria-label="Expand sidebar category 'Chapter 5 - Learning Words'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/en/course/starbook/appendix>Chapter 6 - Postscript</a></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/en/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/en/course/starbook/register><span itemprop=name>Chapter 2 - User Registration</span></a><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>2.4 Business Optimization</span><meta itemprop=position content=2></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 2.8.x(Latest)</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><p>There are several significant issues that need to be optimized in the current registration process:</p>
<ul>
<li>Interface parameters are not validated, meaning entries with empty or random values can be successfully stored. Therefore, username, password, and email should be required, with a certain level of security verification. For example, passwords should be between <code>6-12</code> characters, and emails should follow the <code>xx@xx.xx</code> format;</li>
<li>Prohibiting the registration of identical users;</li>
<li>Passwords should not be stored in plain text but should be encrypted before storage;</li>
<li>The <code>logic/Register</code> function has too many parameters, which is neither elegant nor maintainable. User information should be defined in a structure and used as a function parameter.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=parameter-validation>Parameter Validation<a href=#parameter-validation class=hash-link aria-label="Direct link to Parameter Validation" title="Direct link to Parameter Validation">​</a></h2>
<hr>
<p><code>GoFrame</code> has built-in powerful interface parameter validation features, which can be enabled by adding <code>v</code> to the <code>g.Meta</code> tag.</p>
<p><em>api/users/v1/users.go</em></p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token keyword" style=color:#66d9ef>package</span><span class="token plain"> v1  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token keyword" style=color:#66d9ef>import</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"github.com/gogf/gf/v2/frame/g"</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token keyword" style=color:#66d9ef>type</span><span class="token plain"> RegisterReq </span><span class="token keyword" style=color:#66d9ef>struct</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    g</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Meta   </span><span class="token string" style=color:#a6e22e>`path:"users/register" method:"post"`</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    Username </span><span class="token builtin" style=color:#e6db74>string</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>`json:"username" v:"required|length:3,12"`</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    Password </span><span class="token builtin" style=color:#e6db74>string</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>`json:"password" v:"required|length:6,16"`</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    Email    </span><span class="token builtin" style=color:#e6db74>string</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>`json:"email" v:"required|email"`</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token keyword" style=color:#66d9ef>type</span><span class="token plain"> RegisterRes </span><span class="token keyword" style=color:#66d9ef>struct</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Multiple validation rules are separated by <code>|</code>, <code>required</code> indicates the field is mandatory, <code>length</code> indicates the length is between <code>3-12</code>, and <code>email</code> indicates only valid email addresses are accepted. Available validation rules can be found in the <a href=https://goframe.org/docs/core/gvalid-rules target=_blank rel="noopener noreferrer">Developer's Manual</a>.</p>
<p>Testing with an empty username request:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">$ </span><span class="token function" style=color:#e6db74>curl</span><span class="token plain"> </span><span class="token parameter variable" style=color:#f8f8f2>-X</span><span class="token plain"> POST http://127.0.0.1:8000/v1/users/register </span><span class="token parameter variable" style=color:#f8f8f2>-H</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"Content-Type: application/json"</span><span class="token plain"> </span><span class="token parameter variable" style=color:#f8f8f2>-d</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>password</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>:</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>123456</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>, </span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>email</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>:</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>tyyn1022@gmail.com</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>}"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token string" style=color:#a6e22e>"code"</span><span class="token plain">:51,</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token string" style=color:#a6e22e>"message"</span><span class="token builtin class-name" style=color:#e6db74>:</span><span class="token string" style=color:#a6e22e>"The Username field is required"</span><span class="token plain">,</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token string" style=color:#a6e22e>"data"</span><span class="token plain">:null</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><code>The Username field is required</code> indicates that the username cannot be empty.</p>
<p>If you are not satisfied with the English prompt, you can use the i18n component provided by the framework to change it to a Chinese prompt.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=parameter-validation-i18n>Parameter Validation i18n<a href=#parameter-validation-i18n class=hash-link aria-label="Direct link to Parameter Validation i18n" title="Direct link to Parameter Validation i18n">​</a></h3>
<p>Download the file from <a href=https://github.com/gogf/gf/blob/master/util/gvalid/testdata/i18n/cn/validation.toml target=_blank rel="noopener noreferrer">Github</a> and store it in the <code>manifest/i18n</code> directory, or simply copy it from below.</p>
<p><em>manifest/i18n/zh-CN/validation.toml</em></p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token key property" style=color:#f92672>"gf.gvalid.rule.required"</span><span class="token plain">             </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field cannot be empty"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.required-if"</span><span class="token plain">          </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field cannot be empty"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.required-unless"</span><span class="token plain">      </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field cannot be empty"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.required-with"</span><span class="token plain">        </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field cannot be empty"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.required-with-all"</span><span class="token plain">    </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field cannot be empty"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.required-without"</span><span class="token plain">     </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field cannot be empty"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.required-without-all"</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field cannot be empty"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.date"</span><span class="token plain">                 </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` does not match date format Y-m-d, e.g.: 2001-02-03"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.datetime"</span><span class="token plain">             </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` does not match datetime format Y-m-d H:i:s, e.g.: 2001-02-03 12:00:00"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.date-format"</span><span class="token plain">          </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` does not match the specified format {format}"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.email"</span><span class="token plain">                </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` is not a valid email address format"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.phone"</span><span class="token plain">                </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` is not a valid phone number format"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.phone-loose"</span><span class="token plain">          </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` is not a valid phone number format"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.telephone"</span><span class="token plain">            </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` is not a valid telephone number format"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.passport"</span><span class="token plain">             </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` is not a valid account format, must start with a letter and can only contain letters, numbers, and underscores, with a length of 6~18"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.password"</span><span class="token plain">             </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` is not a valid password format, must be any visible character of length 6-18"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.password2"</span><span class="token plain">            </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` is not a valid password format, must be any visible character of length 6-18, containing uppercase and lowercase letters and numbers"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.password3"</span><span class="token plain">            </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` is not a valid password format, must be any visible character of length 6-18, containing uppercase and lowercase letters, numbers, and special characters"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.postcode"</span><span class="token plain">             </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` is not a valid postal code"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.resident-id"</span><span class="token plain">          </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` is not a valid resident ID number format"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.bank-card"</span><span class="token plain">            </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` is not a valid bank card number format"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.qq"</span><span class="token plain">                   </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` is not a valid QQ number format"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.ip"</span><span class="token plain">                   </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` is not a valid IP address format"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.ipv4"</span><span class="token plain">                 </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` is not a valid IPv4 address format"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.ipv6"</span><span class="token plain">                 </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` is not a valid IPv6 address format"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.mac"</span><span class="token plain">                  </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` is not a valid MAC address format"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.url"</span><span class="token plain">                  </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` is not a valid URL format"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.domain"</span><span class="token plain">               </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` is not a valid domain format"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.length"</span><span class="token plain">               </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` length should be between {min} and {max} characters"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.min-length"</span><span class="token plain">           </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` minimum length should be {min}"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.max-length"</span><span class="token plain">           </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` maximum length should be {max}"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.size"</span><span class="token plain">                 </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` length must be {size}"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.between"</span><span class="token plain">              </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` size should be between {min} and {max}"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.min"</span><span class="token plain">                  </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` minimum value should be {min}"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.max"</span><span class="token plain">                  </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` maximum value should be {max}"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.json"</span><span class="token plain">                 </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` should be in JSON format"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.xml"</span><span class="token plain">                  </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` should be in XML format"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.array"</span><span class="token plain">                </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` should be an array"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.integer"</span><span class="token plain">              </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` should be an integer"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.float"</span><span class="token plain">                </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` should be a float"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.boolean"</span><span class="token plain">              </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` should be a boolean"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.same"</span><span class="token plain">                 </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` must be the same as {field}"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.different"</span><span class="token plain">            </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` cannot be the same as {field}"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.in"</span><span class="token plain">                   </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` should be within the range: {pattern}"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.not-in"</span><span class="token plain">               </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` should not be within the range: {pattern}"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.regex"</span><span class="token plain">                </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` does not match the rule: {pattern}"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"gf.gvalid.rule.__default__"</span><span class="token plain">          </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{field} field value `{value}` is not valid"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"CustomMessage"</span><span class="token plain">                       </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"Custom Error"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token key property" style=color:#f92672>"project id must between {min}, {max}"</span><span class="token plain">  </span><span class="token punctuation" style=color:#f8f8f2>=</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"Project ID must be greater than or equal to {min} and less than or equal to {max}"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Modify the main function to enable <code>i18n</code>:</p>
<p><em>main.go</em></p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token keyword" style=color:#66d9ef>package</span><span class="token plain"> main  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">···</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token keyword" style=color:#66d9ef>func</span><span class="token plain"> </span><span class="token function" style=color:#e6db74>main</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token keyword" style=color:#66d9ef>var</span><span class="token plain"> err </span><span class="token builtin" style=color:#e6db74>error</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token comment" style=color:#8292a2;font-style:italic>// Globally set i18n  </span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    g</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>I18n</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>SetLanguage</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token string" style=color:#a6e22e>"zh-CN"</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token comment" style=color:#8292a2;font-style:italic>// Check if the database can be connected  </span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    err </span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain"> </span><span class="token function" style=color:#e6db74>connDb</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token keyword" style=color:#66d9ef>if</span><span class="token plain"> err </span><span class="token operator" style=color:#66d9ef>!=</span><span class="token plain"> </span><span class="token boolean" style=color:#ae81ff>nil</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">       </span><span class="token function" style=color:#e6db74>panic</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">err</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    cmd</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Main</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>Run</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">gctx</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>GetInitCtx</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">···</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Make another request:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">$ </span><span class="token function" style=color:#e6db74>curl</span><span class="token plain"> </span><span class="token parameter variable" style=color:#f8f8f2>-X</span><span class="token plain"> POST http://127.0.0.1:8000/v1/users/register </span><span class="token parameter variable" style=color:#f8f8f2>-H</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"Content-Type: application/json"</span><span class="token plain"> </span><span class="token parameter variable" style=color:#f8f8f2>-d</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>password</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>:</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>123456</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>, </span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>email</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>:</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>tyyn1022@gmail.com</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>}"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token string" style=color:#a6e22e>"code"</span><span class="token plain">:51,</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token string" style=color:#a6e22e>"message"</span><span class="token builtin class-name" style=color:#e6db74>:</span><span class="token string" style=color:#a6e22e>"Username field cannot be empty"</span><span class="token plain">,</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token string" style=color:#a6e22e>"data"</span><span class="token plain">:null</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>You can see that the <code>message</code> has been changed to a Chinese prompt.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=prevent-duplicate-usernames>Prevent Duplicate Usernames<a href=#prevent-duplicate-usernames class=hash-link aria-label="Direct link to Prevent Duplicate Usernames" title="Direct link to Prevent Duplicate Usernames">​</a></h2>
<hr>
<p>Usernames are an important basis for login. If there are two users with the same name in the system, it will cause major logical confusion. Therefore, we need to check if the user exists before data is stored. If it exists, return an error message indicating that the user already exists.</p>
<p><em>internal/logic/users/register.go</em></p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token keyword" style=color:#66d9ef>package</span><span class="token plain"> users  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token operator" style=color:#66d9ef>...</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token keyword" style=color:#66d9ef>func</span><span class="token plain"> </span><span class="token function" style=color:#e6db74>Register</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">ctx context</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Context</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> username</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> password</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> email </span><span class="token builtin" style=color:#e6db74>string</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"> </span><span class="token builtin" style=color:#e6db74>error</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token keyword" style=color:#66d9ef>if</span><span class="token plain"> err </span><span class="token operator" style=color:#66d9ef>:=</span><span class="token plain"> </span><span class="token function" style=color:#e6db74>checkUser</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">ctx</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> username</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>;</span><span class="token plain"> err </span><span class="token operator" style=color:#66d9ef>!=</span><span class="token plain"> </span><span class="token boolean" style=color:#ae81ff>nil</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">       </span><span class="token keyword" style=color:#66d9ef>return</span><span class="token plain"> err  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token boolean" style=color:#ae81ff>_</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> err </span><span class="token operator" style=color:#66d9ef>:=</span><span class="token plain"> dao</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Users</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>Ctx</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">ctx</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>Data</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">do</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Users</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">       Username</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> username</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">       Password</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> password</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">       Email</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain">    email</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>Insert</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token keyword" style=color:#66d9ef>if</span><span class="token plain"> err </span><span class="token operator" style=color:#66d9ef>!=</span><span class="token plain"> </span><span class="token boolean" style=color:#ae81ff>nil</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">       </span><span class="token keyword" style=color:#66d9ef>return</span><span class="token plain"> err  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token keyword" style=color:#66d9ef>return</span><span class="token plain"> </span><span class="token boolean" style=color:#ae81ff>nil</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token keyword" style=color:#66d9ef>func</span><span class="token plain"> </span><span class="token function" style=color:#e6db74>checkUser</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">ctx context</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Context</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> username </span><span class="token builtin" style=color:#e6db74>string</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"> </span><span class="token builtin" style=color:#e6db74>error</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    count</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> err </span><span class="token operator" style=color:#66d9ef>:=</span><span class="token plain"> dao</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Users</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>Ctx</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">ctx</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>Where</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token string" style=color:#a6e22e>"username"</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> username</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>Count</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token keyword" style=color:#66d9ef>if</span><span class="token plain"> err </span><span class="token operator" style=color:#66d9ef>!=</span><span class="token plain"> </span><span class="token boolean" style=color:#ae81ff>nil</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">       </span><span class="token keyword" style=color:#66d9ef>return</span><span class="token plain"> err  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token keyword" style=color:#66d9ef>if</span><span class="token plain"> count </span><span class="token operator" style=color:#66d9ef>></span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>0</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">       </span><span class="token keyword" style=color:#66d9ef>return</span><span class="token plain"> gerror</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>New</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token string" style=color:#a6e22e>"User already exists"</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token keyword" style=color:#66d9ef>return</span><span class="token plain"> </span><span class="token boolean" style=color:#ae81ff>nil</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Test the request result:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token plain">$ </span><span class="token function" style=color:#e6db74>curl</span><span class="token plain"> </span><span class="token parameter variable" style=color:#f8f8f2>-X</span><span class="token plain"> POST http://127.0.0.1:8000/v1/users/register </span><span class="token parameter variable" style=color:#f8f8f2>-H</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"Content-Type: application/json"</span><span class="token plain"> </span><span class="token parameter variable" style=color:#f8f8f2>-d</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>username</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>:</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>oldme</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>, </span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>password</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>:</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>123456</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>, </span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>email</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>:</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>tyyn1022@gmail.com</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>}"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token string" style=color:#a6e22e>"code"</span><span class="token plain">:50,</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token string" style=color:#a6e22e>"message"</span><span class="token builtin class-name" style=color:#e6db74>:</span><span class="token string" style=color:#a6e22e>"User already exists"</span><span class="token plain">,</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token string" style=color:#a6e22e>"data"</span><span class="token plain">:null</span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Code detection alone is not sufficient for security. We can add a unique index in the data table to enforce user uniqueness.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token keyword" style=color:#66d9ef>ALTER</span><span class="token plain"> </span><span class="token keyword" style=color:#66d9ef>TABLE</span><span class="token plain"> users </span><span class="token keyword" style=color:#66d9ef>ADD</span><span class="token plain"> </span><span class="token keyword" style=color:#66d9ef>UNIQUE</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">username</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>;</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=password-encryption>Password Encryption<a href=#password-encryption class=hash-link aria-label="Direct link to Password Encryption" title="Direct link to Password Encryption">​</a></h2>
<hr>
<p>Saving passwords in plain text is very insecure. A common practice is to perform a <code>hash</code> calculation before saving to the database, such as <code>md5</code> or <code>SHA-1</code>.</p>
<p>Add a new function <code>encryptPassword</code> to implement password encryption functionality.</p>
<p><em>internal/logic/users/utility.go</em></p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token keyword" style=color:#66d9ef>package</span><span class="token plain"> users  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token keyword" style=color:#66d9ef>import</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"github.com/gogf/gf/v2/crypto/gmd5"</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token keyword" style=color:#66d9ef>func</span><span class="token plain"> </span><span class="token function" style=color:#e6db74>encryptPassword</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">password </span><span class="token builtin" style=color:#e6db74>string</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"> </span><span class="token builtin" style=color:#e6db74>string</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token keyword" style=color:#66d9ef>return</span><span class="token plain"> gmd5</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>MustEncryptString</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">password</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>The <code>gmd5</code> component helps us quickly implement <code>md5</code> encryption functionality. Write registration logic code and introduce password encryption.</p>
<p><em>internal/logic/users/register.go</em></p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token keyword" style=color:#66d9ef>package</span><span class="token plain"> users  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token operator" style=color:#66d9ef>...</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token keyword" style=color:#66d9ef>func</span><span class="token plain"> </span><span class="token function" style=color:#e6db74>Register</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">ctx context</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Context</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> username</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> password</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> email </span><span class="token builtin" style=color:#e6db74>string</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"> </span><span class="token builtin" style=color:#e6db74>error</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token operator" style=color:#66d9ef>...</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token boolean" style=color:#ae81ff>_</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> err </span><span class="token operator" style=color:#66d9ef>:=</span><span class="token plain"> dao</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Users</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>Ctx</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">ctx</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>Data</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">do</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Users</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">       Username</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> username</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">       Password</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token function" style=color:#e6db74>encryptPassword</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">password</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">       Email</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain">    email</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>Insert</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token keyword" style=color:#66d9ef>if</span><span class="token plain"> err </span><span class="token operator" style=color:#66d9ef>!=</span><span class="token plain"> </span><span class="token boolean" style=color:#ae81ff>nil</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">       </span><span class="token keyword" style=color:#66d9ef>return</span><span class="token plain"> err  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token keyword" style=color:#66d9ef>return</span><span class="token plain"> </span><span class="token boolean" style=color:#ae81ff>nil</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token operator" style=color:#66d9ef>...</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Delete the original user:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token keyword" style=color:#66d9ef>DELETE</span><span class="token plain"> </span><span class="token keyword" style=color:#66d9ef>FROM</span><span class="token plain"> users </span><span class="token keyword" style=color:#66d9ef>WHERE</span><span class="token plain"> id </span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain"> </span><span class="token number" style=color:#ae81ff>1</span><span class="token punctuation" style=color:#f8f8f2>;</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Request the interface again to see if the password is successfully encrypted:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token function" style=color:#e6db74>curl</span><span class="token plain"> </span><span class="token parameter variable" style=color:#f8f8f2>-X</span><span class="token plain"> POST http://127.0.0.1:8000/v1/users/register </span><span class="token parameter variable" style=color:#f8f8f2>-H</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"Content-Type: application/json"</span><span class="token plain"> </span><span class="token parameter variable" style=color:#f8f8f2>-d</span><span class="token plain"> </span><span class="token string" style=color:#a6e22e>"{</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>username</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>:</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>oldme</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>, </span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>password</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>:</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>123456</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>, </span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>email</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>:</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>tyyn1022@gmail.com</span><span class="token string entity" style=color:#a6e22e>\"</span><span class="token string" style=color:#a6e22e>}"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Result:</p>
<table><thead><tr><th>ID<th>Username<th>Password<th>Email<th>Created_At<th>Updated_At<tbody><tr><td>1<td>oldme<td>e10adc3949ba59abbe56e057f20f883e<td><a href=mailto:tyyn1022@gmail.com target=_blank rel="noopener noreferrer">tyyn1022@gmail.com</a><td>2024-11-08 10:36:48<td>2024-11-08 10:36:48</table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=register-function-optimization>Register Function Optimization<a href=#register-function-optimization class=hash-link aria-label="Direct link to Register Function Optimization" title="Direct link to Register Function Optimization">​</a></h2>
<hr>
<p>Customize a data model in the <code>model</code> layer for use as input parameters in the <code>Logic</code> layer.</p>
<p><em>internal/model/users.go</em></p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token keyword" style=color:#66d9ef>package</span><span class="token plain"> model  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token keyword" style=color:#66d9ef>type</span><span class="token plain"> UserInput </span><span class="token keyword" style=color:#66d9ef>struct</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    Username </span><span class="token builtin" style=color:#e6db74>string</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    Password </span><span class="token builtin" style=color:#e6db74>string</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    Email    </span><span class="token builtin" style=color:#e6db74>string</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><em>internal/logic/users/register.go</em></p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token keyword" style=color:#66d9ef>package</span><span class="token plain"> users  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token keyword" style=color:#66d9ef>import</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token string" style=color:#a6e22e>"star/internal/model"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token operator" style=color:#66d9ef>...</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token keyword" style=color:#66d9ef>func</span><span class="token plain"> </span><span class="token function" style=color:#e6db74>Register</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">ctx context</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Context</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> in </span><span class="token operator" style=color:#66d9ef>*</span><span class="token plain">model</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">UserInput</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"> </span><span class="token builtin" style=color:#e6db74>error</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token keyword" style=color:#66d9ef>if</span><span class="token plain"> err </span><span class="token operator" style=color:#66d9ef>:=</span><span class="token plain"> </span><span class="token function" style=color:#e6db74>CheckUser</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">ctx</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> in</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Username</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>;</span><span class="token plain"> err </span><span class="token operator" style=color:#66d9ef>!=</span><span class="token plain"> </span><span class="token boolean" style=color:#ae81ff>nil</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">       </span><span class="token keyword" style=color:#66d9ef>return</span><span class="token plain"> err  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token boolean" style=color:#ae81ff>_</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> err </span><span class="token operator" style=color:#66d9ef>:=</span><span class="token plain"> dao</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Users</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>Ctx</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">ctx</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>Data</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">do</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Users</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">       Username</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> in</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Username</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">       Password</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> </span><span class="token function" style=color:#e6db74>encryptPassword</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">in</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Password</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">       Email</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain">    in</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Email</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>Insert</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token keyword" style=color:#66d9ef>if</span><span class="token plain"> err </span><span class="token operator" style=color:#66d9ef>!=</span><span class="token plain"> </span><span class="token boolean" style=color:#ae81ff>nil</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">       </span><span class="token keyword" style=color:#66d9ef>return</span><span class="token plain"> err  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token keyword" style=color:#66d9ef>return</span><span class="token plain"> </span><span class="token boolean" style=color:#ae81ff>nil</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token operator" style=color:#66d9ef>...</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Change the <code>Controller</code> layer to pass in <code>UserInput</code>.</p>
<p><em>internal/controller/users/users_v1_register.go</em></p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#f8f8f2;--prism-background-color:#272822><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#f8f8f2;background-color:#272822><code class=codeBlockLines_e6Vv><span class=token-line style=color:#f8f8f2><span class="token keyword" style=color:#66d9ef>package</span><span class="token plain"> users  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token keyword" style=color:#66d9ef>import</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token string" style=color:#a6e22e>"star/internal/model"</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token operator" style=color:#66d9ef>...</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token keyword" style=color:#66d9ef>func</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">c </span><span class="token operator" style=color:#66d9ef>*</span><span class="token plain">ControllerV1</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"> </span><span class="token function" style=color:#e6db74>Register</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">ctx context</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Context</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> req </span><span class="token operator" style=color:#66d9ef>*</span><span class="token plain">v1</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">RegisterReq</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">res </span><span class="token operator" style=color:#66d9ef>*</span><span class="token plain">v1</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">RegisterRes</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> err </span><span class="token builtin" style=color:#e6db74>error</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    err </span><span class="token operator" style=color:#66d9ef>=</span><span class="token plain"> users</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token function" style=color:#e6db74>Register</span><span class="token punctuation" style=color:#f8f8f2>(</span><span class="token plain">ctx</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> </span><span class="token operator" style=color:#66d9ef>&</span><span class="token plain">model</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">UserInput</span><span class="token punctuation" style=color:#f8f8f2>{</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">       Username</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> req</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Username</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">       Password</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain"> req</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Password</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">       Email</span><span class="token punctuation" style=color:#f8f8f2>:</span><span class="token plain">    req</span><span class="token punctuation" style=color:#f8f8f2>.</span><span class="token plain">Email</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token punctuation" style=color:#f8f8f2>}</span><span class="token punctuation" style=color:#f8f8f2>)</span><span class="token plain">  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain">    </span><span class="token keyword" style=color:#66d9ef>return</span><span class="token plain"> </span><span class="token boolean" style=color:#ae81ff>nil</span><span class="token punctuation" style=color:#f8f8f2>,</span><span class="token plain"> err  </span><br></span><span class=token-line style=color:#f8f8f2><span class="token plain"></span><span class="token punctuation" style=color:#f8f8f2>}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href=https://github.com/gogf/gf-site/blob/main/docs/course/starbook/第二章-用户注册/2.4.业务优化.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class=theme-last-updated>Last updated<!-- --> on <b><time datetime=2024-11-24T14:31:39.000Z itemprop=dateModified>Nov 24, 2024</time></b> by <b>John</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/en/course/starbook/register-general><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>2.3 Registration API</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/en/course/starbook/register-api-doc><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>2.5 API Documentation</div></a></nav><div class=docusaurus-mt-lg></div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#parameter-validation class="table-of-contents__link toc-highlight">Parameter Validation</a><ul><li><a href=#parameter-validation-i18n class="table-of-contents__link toc-highlight">Parameter Validation i18n</a></ul><li><a href=#prevent-duplicate-usernames class="table-of-contents__link toc-highlight">Prevent Duplicate Usernames</a><li><a href=#password-encryption class="table-of-contents__link toc-highlight">Password Encryption</a><li><a href=#register-function-optimization class="table-of-contents__link toc-highlight">Register Function Optimization</a></ul></div></div></div></div></main></div></div></div><footer class=footer><div class="container container-fluid"><div class="footer__bottom text--center"><div class=footer__copyright>Copyright ©2024 GoFrame OpenSource Team</div></div></div></footer></div>