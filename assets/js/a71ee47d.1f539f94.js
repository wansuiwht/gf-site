"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["43342"],{537386:function(e,n,r){r.r(n),r.d(n,{metadata:()=>t,contentTitle:()=>d,default:()=>h,assets:()=>l,toc:()=>c,frontMatter:()=>s});var t=JSON.parse('{"id":"course/starbook/\u7B2C\u56DB\u7AE0-\u5355\u8BCD\u7BA1\u7406/4.5.\u5355\u8BCD\u5206\u9875\u5217\u8868","title":"4.5.\u5355\u8BCD\u5206\u9875\u5217\u8868","description":"\u4F7F\u7528GET\u65B9\u5F0F\u67E5\u8BE2\u5355\u8BCD\u7684\u5206\u9875\u5217\u8868\uFF0C\u5305\u542B\u6A21\u7CCA\u67E5\u8BE2\u529F\u80FD\u3002\u5B9A\u4E49\u7ED3\u6784\u4F53\u4FDD\u5B58\u5355\u8BCD\u5B57\u6BB5\uFF0C\u5305\u62ECid\u3001\u5355\u8BCD\u3001\u5B9A\u4E49\u53CA\u719F\u7EC3\u5EA6\u3002\u5728GoFrame\u6846\u67B6\u4E2D\u7F16\u5199Logic\uFF0C\u7528\u4E8E\u5904\u7406\u6570\u636E\u7684\u67E5\u8BE2\u548C\u5206\u9875\u64CD\u4F5C\u3002\u901A\u8FC7Controller\u8C03\u7528Logic\uFF0C\u5B9E\u73B0\u6570\u636E\u7684\u83B7\u53D6\u548C\u8FD4\u56DE\uFF0C\u652F\u6301\u7EFC\u5408\u7684\u63A5\u53E3\u6D4B\u8BD5\u3002","source":"@site/docs/course/starbook/\u7B2C\u56DB\u7AE0-\u5355\u8BCD\u7BA1\u7406/4.5.\u5355\u8BCD\u5206\u9875\u5217\u8868.md","sourceDirName":"course/starbook/\u7B2C\u56DB\u7AE0-\u5355\u8BCD\u7BA1\u7406","slug":"/course/starbook/word-list","permalink":"/course/starbook/word-list","draft":false,"unlisted":false,"editUrl":"https://github.com/gogf/gf-site/blob/main/docs/course/starbook/\u7B2C\u56DB\u7AE0-\u5355\u8BCD\u7BA1\u7406/4.5.\u5355\u8BCD\u5206\u9875\u5217\u8868.md","tags":[],"version":"current","lastUpdatedBy":"oldme","lastUpdatedAt":1732847112000,"frontMatter":{"title":"4.5.\u5355\u8BCD\u5206\u9875\u5217\u8868","hide_title":true,"slug":"/course/starbook/word-list","keywords":["GoFrame","\u5355\u8BCD\u67E5\u8BE2","API\u5206\u9875","\u6A21\u7CCA\u67E5\u8BE2","\u6570\u636E\u7ED3\u6784","\u5355\u8BCD\u5217\u8868","\u63A5\u53E3\u6D4B\u8BD5","GoFrame\u6846\u67B6","API\u8BF7\u6C42","\u6570\u636E\u5904\u7406"],"description":"\u4F7F\u7528GET\u65B9\u5F0F\u67E5\u8BE2\u5355\u8BCD\u7684\u5206\u9875\u5217\u8868\uFF0C\u5305\u542B\u6A21\u7CCA\u67E5\u8BE2\u529F\u80FD\u3002\u5B9A\u4E49\u7ED3\u6784\u4F53\u4FDD\u5B58\u5355\u8BCD\u5B57\u6BB5\uFF0C\u5305\u62ECid\u3001\u5355\u8BCD\u3001\u5B9A\u4E49\u53CA\u719F\u7EC3\u5EA6\u3002\u5728GoFrame\u6846\u67B6\u4E2D\u7F16\u5199Logic\uFF0C\u7528\u4E8E\u5904\u7406\u6570\u636E\u7684\u67E5\u8BE2\u548C\u5206\u9875\u64CD\u4F5C\u3002\u901A\u8FC7Controller\u8C03\u7528Logic\uFF0C\u5B9E\u73B0\u6570\u636E\u7684\u83B7\u53D6\u548C\u8FD4\u56DE\uFF0C\u652F\u6301\u7EFC\u5408\u7684\u63A5\u53E3\u6D4B\u8BD5\u3002"},"sidebar":"courseStarBookSidebar","previous":{"title":"4.4.\u7F16\u8F91\u5355\u8BCD","permalink":"/course/starbook/word-update"},"next":{"title":"4.6.\u5355\u8BCD\u8BE6\u60C5","permalink":"/course/starbook/word-detail"}}'),i=r("785893"),o=r("250065");let s={title:"4.5.\u5355\u8BCD\u5206\u9875\u5217\u8868",hide_title:!0,slug:"/course/starbook/word-list",keywords:["GoFrame","\u5355\u8BCD\u67E5\u8BE2","API\u5206\u9875","\u6A21\u7CCA\u67E5\u8BE2","\u6570\u636E\u7ED3\u6784","\u5355\u8BCD\u5217\u8868","\u63A5\u53E3\u6D4B\u8BD5","GoFrame\u6846\u67B6","API\u8BF7\u6C42","\u6570\u636E\u5904\u7406"],description:"\u4F7F\u7528GET\u65B9\u5F0F\u67E5\u8BE2\u5355\u8BCD\u7684\u5206\u9875\u5217\u8868\uFF0C\u5305\u542B\u6A21\u7CCA\u67E5\u8BE2\u529F\u80FD\u3002\u5B9A\u4E49\u7ED3\u6784\u4F53\u4FDD\u5B58\u5355\u8BCD\u5B57\u6BB5\uFF0C\u5305\u62ECid\u3001\u5355\u8BCD\u3001\u5B9A\u4E49\u53CA\u719F\u7EC3\u5EA6\u3002\u5728GoFrame\u6846\u67B6\u4E2D\u7F16\u5199Logic\uFF0C\u7528\u4E8E\u5904\u7406\u6570\u636E\u7684\u67E5\u8BE2\u548C\u5206\u9875\u64CD\u4F5C\u3002\u901A\u8FC7Controller\u8C03\u7528Logic\uFF0C\u5B9E\u73B0\u6570\u636E\u7684\u83B7\u53D6\u548C\u8FD4\u56DE\uFF0C\u652F\u6301\u7EFC\u5408\u7684\u63A5\u53E3\u6D4B\u8BD5\u3002"},d=void 0,l={},c=[{value:"\u6DFB\u52A0Api",id:"\u6DFB\u52A0api",level:2},{value:"\u7F16\u5199Logic",id:"\u7F16\u5199logic",level:2},{value:"Controller\u8C03\u7528Logic",id:"controller\u8C03\u7528logic",level:2},{value:"\u63A5\u53E3\u6D4B\u8BD5",id:"\u63A5\u53E3\u6D4B\u8BD5",level:2}];function a(e){let n={code:"code",em:"em",h2:"h2",hr:"hr",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,o.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["\u67E5\u8BE2\u5355\u8BCD\u5206\u9875\u5217\u8868\u4F7F\u7528",(0,i.jsx)(n.code,{children:"GET"}),"\u65B9\u5F0F\uFF0C\u5E76\u4E14\u63D0\u4F9B\u4E00\u4E9B\u5165\u53C2\uFF1A"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u5B57\u6BB5\u540D"}),(0,i.jsx)(n.th,{children:"\u7C7B\u578B"}),(0,i.jsx)(n.th,{children:"json"}),(0,i.jsx)(n.th,{children:"valid"}),(0,i.jsx)(n.th,{children:"\u63CF\u8FF0"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Word"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"string"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:'json:"word"'})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"length:1,100"})}),(0,i.jsx)(n.td,{children:"\u6A21\u7CCA\u67E5\u8BE2\u5355\u8BCD"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Page"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"int"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:'json:"page"'})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"min:1"})}),(0,i.jsx)(n.td,{children:"\u9875\u7801\uFF0C\u9ED8\u8BA41"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Size"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"int"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:'json:"size"'})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"between:1,100"})}),(0,i.jsx)(n.td,{children:"\u6BCF\u9875\u6570\u91CF\uFF0C\u9ED8\u8BA410"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"\u6DFB\u52A0api",children:"\u6DFB\u52A0Api"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:"\u9996\u5148\uFF0C\u6211\u4EEC\u5B9A\u4E49\u4E00\u4E2A\u7ED3\u6784\u4F53\u4FDD\u5B58\u4E00\u4E2A\u5355\u8BCD\u7684\u5B57\u6BB5\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"api/words/v1/words_struct.go"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'package v1\n\nimport "star/internal/model"\n\ntype List struct {\n	Id               uint                   `json:"id"`\n	Word             string                 `json:"word"`\n	Definition       string                 `json:"definition"`\n	ProficiencyLevel model.ProficiencyLevel `json:"proficiencyLevel"`\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u5728",(0,i.jsx)(n.code,{children:"ListRes"}),"\u4E2D\u8FD4\u56DE\u4E00\u4E2A",(0,i.jsx)(n.code,{children:"List"}),"\u5207\u7247\uFF0C\u8868\u793A\u5355\u8BCD\u5217\u8868\uFF0C",(0,i.jsx)(n.code,{children:"Total"}),"\u8868\u793A\u6240\u6709\u5355\u8BCD\u6570\u91CF\uFF0C\u8FD4\u56DE\u7ED9\u524D\u7AEF\u65B9\u4FBF\u505A\u5206\u9875\u64CD\u4F5C\u3002"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"api/words/v1/words.go"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'...\n\ntype ListReq struct {  \n    g.Meta `path:"words" method:"get" sm:"\u5217\u8868" tags:"\u5355\u8BCD"`  \n    Word   string `json:"word" v:"length:1,100" dc:"\u6A21\u7CCA\u67E5\u8BE2\u5355\u8BCD"`  \n    Page   int    `json:"page" v:"min:1" dc:"\u9875\u7801\uFF0C\u9ED8\u8BA41"`  \n    Size   int    `json:"size" v:"between:1,100" dc:"\u6BCF\u9875\u6570\u91CF\uFF0C\u9ED8\u8BA410"`  \n}  \n  \ntype ListRes struct {  \n    List  []List `json:"list"`  \n    Total uint   `json:"total"`  \n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u7F16\u5199logic",children:"\u7F16\u5199Logic"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:["\u5148\u5B9A\u4E49\u4E00\u4E2A",(0,i.jsx)(n.code,{children:"Query"}),"\u7ED3\u6784\u4F53\uFF0C\u7528\u4F5C\u67E5\u8BE2\u5217\u8868\u5165\u53C2\uFF0C\u4E25\u683C\u9075\u5FAA\u6BCF\u4E00\u5C42\u91CD\u65B0\u5B9A\u4E49\u6570\u636E\u7ED3\u6784\u3002"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"internal/model/words.go"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:"...\n\ntype WordQuery struct {  \n    Uid  uint  \n    Word string  \n    Page int  \n    Size int  \n}\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"internal/logic/words/words.go"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'...\n\nfunc List(ctx context.Context, query *model.WordQuery) (list []entity.Words, total uint, err error) {  \n    if query == nil {  \n       query = &model.WordQuery{}  \n    }  \n    // \u5BF9\u4E8E\u67E5\u8BE2\u521D\u59CB\u503C\u7684\u5904\u7406  \n    if query.Page == 0 {  \n       query.Page = 1  \n    }  \n    if query.Size == 0 {  \n       query.Size = 15  \n    }  \n  \n    // \u7EC4\u6210\u67E5\u8BE2\u94FE  \n    db := dao.Words.Ctx(ctx)  \n    if query.Uid > 0 {  \n       db = db.Where("uid", query.Uid)  \n    }  \n  \n    // \u6A21\u7CCA\u67E5\u8BE2  \n    if len(query.Word) != 0 {  \n       db = db.WhereLike("word", fmt.Sprintf("%%%s%%", query.Word))  \n    }  \n    db = db.Order("created_at desc, id desc").Page(query.Page, query.Size)  \n  \n    data, totalInt, err := db.AllAndCount(true)  \n    if err != nil {  \n       return  \n    }  \n  \n    list = []entity.Words{}  \n    _ = data.Structs(&list)  \n    total = uint(totalInt)  \n  \n    return  \n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u4E0A\u8FF0\u4EE3\u7801\u7528\u5230\u4E86",(0,i.jsx)(n.code,{children:'db.WhereLike("word", fmt.Sprintf("%%%s%%", query.Word))'}),"\uFF0C\u5B83\u662F\u6A21\u7CCA\u67E5\u8BE2\u7684\u610F\u601D\uFF0C\u6700\u7EC8\u4F1A\u751F\u6210",(0,i.jsx)(n.code,{children:"word LIKE '%{word}%'"})," \u5B50\u53E5\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"AllAndCount"}),"\u7528\u4E8E\u540C\u65F6\u67E5\u8BE2\u6570\u636E\u8BB0\u5F55\u5217\u8868\u53CA\u603B\u6570\u91CF\uFF0C\u4E00\u822C\u7528\u4E8E\u5206\u9875\u67E5\u8BE2\u573A\u666F\u4E2D\uFF0C\u7B80\u5316\u5206\u9875\u67E5\u8BE2\u903B\u8F91\u3002"]}),"\n",(0,i.jsx)(n.h2,{id:"controller\u8C03\u7528logic",children:"Controller\u8C03\u7528Logic"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"internal/controller/words/words_v1_list.go"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'package words  \n  \nimport (  \n    "context"  \n  \n    "star/api/words/v1"\n    "star/internal/logic/users"\n    "star/internal/logic/words"\n    "star/internal/model"\n)  \n  \nfunc (c *ControllerV1) List(ctx context.Context, req *v1.ListReq) (res *v1.ListRes, err error) {  \n    uid, err := users.GetUid(ctx)  \n    if err != nil {  \n       return nil, err  \n    }  \n  \n    query := &model.WordQuery{  \n       Uid:  uid,  \n       Word: req.Word,  \n       Page: req.Page,  \n       Size: req.Size,  \n    }  \n    wordList, total, err := words.List(ctx, query)  \n    if err != nil {  \n       return nil, err  \n    }  \n  \n    var list []v1.List  \n    for _, v := range wordList {  \n       list = append(list, v1.List{  \n          Id:               v.Id,  \n          Word:             v.Word,  \n          Definition:       v.Definition,  \n          ProficiencyLevel: model.ProficiencyLevel(v.ProficiencyLevel),  \n       })  \n    }  \n  \n    return &v1.ListRes{  \n       List:  list,  \n       Total: total,  \n    }, nil  \n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u63A5\u53E3\u6D4B\u8BD5",children:"\u63A5\u53E3\u6D4B\u8BD5"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'$ curl -X GET http://127.0.0.1:8000/v1/words \\\n     -H "Authorization: eyJhbGci...5U" \\\n     -H "Content-Type: application/json" \\\n\n{\n\xa0 \xa0 "code": 0,\n\xa0 \xa0 "message": "",\n\xa0 \xa0 "data": {\n\xa0 \xa0 \xa0 \xa0 "list": [\n\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 {\n\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 "id": 1,\n\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 "word": "example_update",\n\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 "definition": "A representative form or pattern.",\n\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 "proficiencyLevel": 3\n\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 }\n\xa0 \xa0 \xa0 \xa0 ],\n\xa0 \xa0 \xa0 \xa0 "total": 1\n\xa0 \xa0 }\n}\n'})})]})}function h(e={}){let{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},250065:function(e,n,r){r.d(n,{Z:function(){return d},a:function(){return s}});var t=r(667294);let i={},o=t.createContext(i);function s(e){let n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);